@using GNForm3C_.BAL;
<!DOCTYPE html>
<html lang="en">
<head>
    <base href="">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - GNForm3C+</title>
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://keenthemes.com/metronic" />
    <link rel="canonical" href="https://preview.keenthemes.com/metronic8" />
    <link rel="shortcut icon" href=@CommonVariables.SmallLogo />
    <link rel="stylesheet" href="~/css/site.css" />
    <!--begin::Fonts-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,400,500,600,700" />
    <!--end::Fonts-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

    <!--begin::Vendor Stylesheets(used by this page)-->
    <link href="~/Theme/assets/plugins/custom/fullcalendar/fullcalendar.bundle.css" rel="stylesheet" type="text/css" />
    <link href="~/Theme/assets/plugins/custom/datatables/datatables.bundle.css" rel="stylesheet" type="text/css" />
    <!--end::Vendor Stylesheets-->
    <!--begin::Global Stylesheets Bundle(used by all pages)-->
    <link href="~/Theme/assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
    <link href="~/Theme/assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
    <link href="~/Theme/assets/css/site.css" rel="stylesheet" />
    <!--begin:: Toastr js Notification-->
    <link href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />
    <!--end:: Toastr js Notification-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!--end::Global Stylesheets Bundle-->
</head>
<body data-kt-name="metronic" id="kt_app_body" data-kt-app-layout="dark-sidebar" data-kt-app-header-fixed="true" data-kt-app-sidebar-enabled="true" data-kt-app-sidebar-fixed="true" data-kt-app-sidebar-hoverable="true" data-kt-app-sidebar-push-header="true" data-kt-app-sidebar-push-toolbar="true" data-kt-app-sidebar-push-footer="true" data-kt-app-toolbar-enabled="true" class="app-default">
    <!--begin::Theme mode setup on page load-->
    <script>if (document.documentElement) { const defaultThemeMode = "system"; const name = document.body.getAttribute("data-kt-name"); let themeMode = localStorage.getItem("kt_" + (name !== null ? name + "_" : "") + "theme_mode_value"); if (themeMode === null) { if (defaultThemeMode === "system") { themeMode = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light"; } else { themeMode = defaultThemeMode; } } document.documentElement.setAttribute("data-theme", themeMode); }</script>
    <!--end::Theme mode setup on page load-->
    <!--begin::App-->
    <div class="d-flex flex-column flex-root app-root" id="kt_app_root">
        <!--begin::Page-->
        <div class="app-page flex-column flex-column-fluid" id="kt_app_page">
            <Partial name="_Header" />
            <!--begin::Wrapper-->
            <div class="app-wrapper flex-column flex-row-fluid" id="kt_app_wrapper">
                <Partial name="_Sidebar" />
                <!--begin::Main-->
                <div class="app-main flex-column flex-row-fluid" id="kt_app_main">
                    <!--begin::Content wrapper-->
                    <div class="d-flex flex-column flex-column-fluid">
                        <main role="main" class="pb-3">
                            <partial name="_Notification" />
                            @RenderBody()
                        </main>
                    </div>
                </div>
                <!--end::Wrapper-->
                <Partial name="_Footer" />
            </div>
            <!--end:::Main-->
        </div>
        <!--end::Wrapper-->
    </div>
    <!--end::Page-->
    <!--end::App-->
    <!--begin::modal-->
    <div id="ModalBox"></div>
    <!--end::modal-->
    <!--begin::Javascript-->
    <script>var hostUrl = "~/Theme/assets/";</script>
    <!--begin::Global Javascript Bundle(used by all pages)-->
    <script src="~/Theme/assets/plugins/global/plugins.bundle.js"></script>
    <script src="~/Theme/assets/js/scripts.bundle.js"></script>
    <!--end::Global Javascript Bundle-->
    <!--begin::Vendors Javascript(used by this page)-->
    <script src="~/Theme/assets/plugins/custom/fullcalendar/fullcalendar.bundle.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/xy.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/percent.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/radar.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/map.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/geodata/worldLow.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/geodata/continentsLow.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/geodata/usaLow.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/geodata/worldTimeZonesLow.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/geodata/worldTimeZoneAreasLow.js"></script>

    <script src="~/Theme/assets/plugins/custom/datatables/datatables.bundle.js"></script>
    <!--end::Vendors Javascript-->
    <!--begin::Vendors Javascript(used by this page)-->
    <script src="~/Theme/assets/plugins/custom/datatables/datatables.bundle.js"></script>
    <!--end::Vendors Javascript-->
    <!--begin::Custom Javascript(used by this page)-->
    <script src="~/Theme/assets/js/custom/apps/ecommerce/reports/sales/sales.js"></script>
    <script src="~/Theme/assets/js/custom/apps/ecommerce/reports/returns/returns.js"></script>
    <script src="~/Theme/assets/js/custom/apps/ecommerce/reports/customer-orders/customer-orders.js"></script>

    <script src="~/Theme/assets/js/custom/apps/ecommerce/customers/listing/listing.js"></script>
    <!--begin::Custom Javascript(used by this page)-->
    <script src="~/Theme/assets/js/widgets.bundle.js"></script>
    <script src="~/Theme/assets/js/custom/widgets.js"></script>
    <script src="~/Theme/assets/js/custom/apps/chat/chat.js"></script>
    <script src="~/Theme/assets/js/custom/utilities/modals/upgrade-plan.js"></script>
    <script src="~/Theme/assets/js/custom/utilities/modals/create-app.js"></script>
    <script src="~/Theme/assets/js/custom/utilities/modals/new-target.js"></script>
    <script src="~/Theme/assets/js/custom/utilities/modals/users-search.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    @await RenderSectionAsync("Scripts", required: false)

    <!-- Counter JS files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.js" integrity="sha512-ZKNVEa7gi0Dz4Rq9jXcySgcPiK+5f01CqW+ZoKLLKr9VMXuCsw3RjWiv8ZpIOa0hxO79np7Ec8DDWALM0bDOaQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0.0/jquery.counterup.min.js" integrity="sha512-d8F1J2kyiRowBB/8/pAWsqUl0wSEOkG5KATkVV4slfblq9VRQ6MyDZVxWl2tWd+mPhuCbpTB4M7uU/x9FlgQ9Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        $(document).ready(function () {
            $("#myInput").on("keyup", function () {
                var value = $(this).val().toLowerCase();
                $("#myTable tr").filter(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });
        });
    </script>

    @* script for not accepting negative value *@
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Get the amount input element
            var amountInput = document.getElementById('amountInput');

            // Add an event listener to the input element for input event
            amountInput.addEventListener('input', function (event) {
                // Get the entered value
                var enteredValue = amountInput.value;

                // Remove any non-numeric characters and allowed symbols
                amountInput.value = enteredValue.replace(/[^0-9]/g, '');
            });
        });
    </script>
    @* script for not accepting negative value *@

    // script foe freeze specific column
    <script type="text/javascript">

        $(document).ready(function () {

            var table = $('.Freeze-Table').DataTable();
            new $.fn.dataTable.FixedColumns(table, {
                leftColumns: 0, // Number of columns to freeze on the left (0 in this case)
                rightColumns: 1 // Number of columns to freeze on the right (1 in this case, for the last column)
            });
        });
    </script>

    // script for download excel
    <script type="text/javascript">
        $("#exportBtn").on('click', function () {
            let table = $("#kt_ecommerce_report_customer_orders_table").DataTable();
            let arrayOfArrays = [];

            // Get the table headers and store them in the arrayOfArrays
            let headers = [];
            table.columns().every(function () {
                let headerText = $(this.header()).text().replace(/\s+/g, ' ').trim();
                headers.push(headerText);
            });
            headers.pop();
            // headers.shift();
            arrayOfArrays.push(headers);
            table.rows().every(function () {
                let rowData = [];
                let rowNode = this.node();

                // Get the cells in the current row
                let cells = $(rowNode).find('td');

                // Process each cell in the row
                cells.each(function () {
                    // Get the text of each cell, replace excess whitespace with a single space, and push to rowData
                    let cellText = $(this).text().replace(/\s+/g, ' ').trim();
                    cellText = cellText.replace('Actions Edit Delete', '').trim();

                    rowData.push(cellText);
                });
                rowData.pop();
                // rowData.shift();
                arrayOfArrays.push(rowData);
            });
            // Convert Table Value Array of Array into Array Of Object
            var tableObjects = arrayOfArrays.map(function (row) {
                var obj = {};
                row.forEach(function (value, index) {
                    obj[index] = value;
                });
                return obj;
            });
            // console.log(tableObjects);
            // Download Excel File
            $.ajax({
                url: '@Url.Action("ExportTable","CommonFunctions")',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(tableObjects),
                success: function (response) {
                    if (response == true) {
                        window.location.href = '@Url.Action("DownloadExcel","CommonFunctions", new { FileName = @ViewData["Title"] })';
                    }
                    else
                        window.location.reload();
                },
                error: function (error) {
                    // Handle errors if any
                    console.log(error);
                }
            });
        });
    </script>

    <!--end::Custom Javascript-->
    <!--end::Javascript-->
</body>
</html>
